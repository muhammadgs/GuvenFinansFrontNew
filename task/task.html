<!DOCTYPE html>
<html lang="az" data-theme="light">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Professional Task Management System - ƒ∞≈ü√ßi, ƒ∞≈ü v…ô ∆èm…ôk Haqqƒ± ƒ∞dar…ôetm…ô Sistemi">
    <meta name="author" content="Task Manager Pro">

    <title>Task Manager Pro | ƒ∞≈ü ƒ∞dar…ôetm…ô Paneli</title>

    <!-- Professional Styles -->
    <link rel="stylesheet" href="../assets/css/task_css/task.css" />
    <link rel="stylesheet" href="../assets/css/task_css/edit_module.css" />
    <link rel="stylesheet" href="../assets/css/task_css/buttonManager.css" />
    <link rel="stylesheet" href="../assets/css/task_css/modals.css" />
    <link rel="stylesheet" href="../assets/css/task_css/main.css" />
    <link rel="stylesheet" href="../assets/css/task_css/task_details_modal.css" />

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- XLSX k√ºt√ºphanesi i√ßin CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22 fill=%22%233b82f6%22>üìä</text></svg>">
    <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22 fill=%22%233b82f6%22>üìä</text></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22 fill=%22%233b82f6%22>üìä</text></svg>">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Theme Toggle -->
    <div class="theme-toggle">
        <button id="themeToggle" class="secondary-btn btn-icon" title="Tema d…ôyi≈ü">
            <i class="fas fa-moon"></i>
            <span class="theme-text">Qaranlƒ±q rejim</span>
        </button>
    </div>
        <header>
                <!-- Header Actions -->
                <div class="header-actions header-actions--split">
                    <div class="header-nav-buttons">
                        <button class="secondary-btn nav-btn btn-icon" id="backHomeBtn">
                            <i class="fas fa-home"></i>
                            <span>∆èsas s…ôhif…ô</span>
                        </button>
                        <button class="secondary-btn nav-btn btn-icon" id="backPanelBtn">
                            <i class="fas fa-chart-line"></i>
                            <span>Panel…ô qayƒ±t</span>
                        </button>
                        <button class="secondary-btn nav-btn btn-icon" id="refreshBtn">
                            <i class="fas fa-sync-alt"></i>
                            <span>Yenil…ô</span>
                        </button>
                    </div>

                    <div class="header-task-buttons">
                        <button class="secondary-btn btn-icon" id="openFilterBtn">
                            <i class="fas fa-filter"></i>
                            <span>Filtr</span>
                            <span class="filter-badge" id="filterBadge">0</span>
                        </button>
                        <button class="primary-btn btn-icon" id="openModalBtn">
                            <i class="fas fa-plus"></i>
                            <span>Yeni i≈ü …ôlav…ô et</span>
                        </button>
                        <button class="secondary-btn btn-icon" id="exportBtn" title="Export data">
                            <i class="fas fa-file-export"></i>
                            <span>Export</span>
                        </button>
                        <button class="header-logout-btn" onclick="logoutUser()" id="logoutBtn">
                            <i class="fas fa-sign-out-alt"></i>
                            <span>√áƒ±xƒ±≈ü</span>
                        </button>
                    </div>
                </div>
        </header>

        <!-- Main Content -->
        <main class="page-content">
            <!-- Active Tasks Section -->
            <section class="table-card">
                <div class="table-header">
                    <div class="table-meta">
                        <!-- D√ºym…ôl…ôr solda -->
                        <div class="table-actions">
                           <button class="table-action-btn" id="activeSortBtn" title="Sƒ±rala">
                                <i class="fas fa-sort-amount-down"></i>
                            </button>


                            <button class="table-action-btn" id="activeColumnsBtn" title="S√ºtunlarƒ± y√∂nl…ôndir">
                                <i class="fas fa-columns"></i>
                            </button>

                            <!-- Prev Button -->
                            <button class="table-action-btn" id="prevBtnList" title="∆èvv…ôlki s…ôhif…ô">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <!-- Next Button -->
                            <button class="table-action-btn" id="nextBtnList" title="N√∂vb…ôti s…ôhif…ô">
                                <i class="fas fa-chevron-right"></i>
                            </button>

                        </div>
                        </div>
                        <div class="table-title-group">
                            <h2 class="table-title">
                                <i class="fas fa-tasks table-icon"></i>
                                ≈ûirk…ôtin Aktiv ƒ∞≈ül…ôri
                            </h2>
                            <div class="table-subtitle" id="tableMeta">2 aktiv i≈ü</div>
                        </div>
                    </div>
                </div>
                <div class="table-wrapper">
                    <table class="excel-table data-table">
                        <thead>
                            <tr>
                                <th class="text-center">
                                    <div class="table-header-cell">
                                        <span>S/S</span>
                                    </div>
                                </th>
                                <th>
                                    <div class="table-header-cell">
                                        <span>Tarix</span>
                                    </div>
                                </th>
                                <th>
                                    <div class="table-header-cell">
                                        <span>≈ûirk…ôt</span>
                                    </div>
                                </th>
                                <th>
                                    <div class="table-header-cell">
                                        <span>Kim t…ôr…ôfind…ôn</span>
                                    </div>
                                </th>
                                <th>
                                    <div class="table-header-cell">
                                        <span>ƒ∞cra ed…ôn</span>
                                    </div>
                                </th>

                                <th class="actions-col">
                                    <div class="table-header-cell">
                                        <span>∆èm…ôliyyatlar</span>
                                    </div>
                                </th>
                                <th>
                                    <div class="table-header-cell">
                                        <span>ƒ∞≈üin n√∂v√º</span>
                                    </div>
                                </th>
                                <th class="file-col">
                                    <div class="table-header-cell">
                                        <span>Tap≈üƒ±rƒ±q a√ßƒ±qlamasƒ±</span>
                                    </div>
                                </th>
                                <th class="file-col">
                                    <div class="table-header-cell">
                                        <span>Fayl</span>
                                    </div>
                                </th>
                                <th>
                                    <div class="table-header-cell">
                                        <span>Son m√ºdd…ôt</span>
                                        <button class="sort-btn" data-sort="due_date">
                                            <i class="fas fa-sort"></i>
                                        </button>
                                    </div>
                                </th>
                                <th>
                                    <div class="table-header-cell">
                                        <span>Status</span>
                                    </div>
                                </th>
                                <th>
                                    <div class="table-header-cell">
                                        <span>ƒ∞cra tarixi</span>
                                    </div>
                                </th>
                                <th>
                                    <div class="table-header-cell">
                                        <span>ƒ∞cra m√ºdd…ôti</span>
                                    </div>
                                </th>
                                <th>
                                    <div class="table-header-cell">
                                        <span>Saatlƒ±q …ôm…ôk haqqƒ±</span>
                                    </div>
                                </th>
                                <th>
                                    <div class="table-header-cell">
                                        <span>Formala≈üan …ôm…ôk haqqƒ±</span>
                                    </div>
                                </th>
                                <th>
                                    <div class="table-header-cell">
                                        <span>≈û√∂b…ô</span>
                                    </div>
                                </th>

                            </tr>
                        </thead>
                        <tbody id="tableBody">
                            <!-- Loading State -->
                            <tr class="loading-row">
                                <td colspan="16">
                                    <div class="table-loading">
                                        <div class="loader">
                                            <div></div>
                                            <div></div>
                                        </div>
                                        <p>M…ôlumatlar y√ºkl…ônir...</p>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="table-footer">

                </div>
            </section>

            <!-- External Tasks Section -->
            <section class="table-card external-section">
                <div class="table-header">
                    <div class="table-meta">
                        <!-- ∆èM∆èLƒ∞YYAT D√úYM∆èL∆èRƒ∞ (SOLDA) -->
                        <div class="table-actions">
                            <button class="table-action-btn" id="externalSortBtn" title="Sƒ±rala">
                                <i class="fas fa-sort-amount-down"></i>
                            </button>

                            <button class="table-action-btn" id="externalColumnsBtn" title="S√ºtunlarƒ± y√∂nl…ôndir">
                                <i class="fas fa-columns"></i>
                            </button>
                            <!-- Prev Button -->
                            <button class="table-action-btn" id="externalPrevBtn" title="∆èvv…ôlki s…ôhif…ô">
                                <i class="fas fa-chevron-left"></i>
                            </button>

                            <!-- Next Button -->
                            <button class="table-action-btn" id="externalNextBtn" title="N√∂vb…ôti s…ôhif…ô">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>

                        <!-- BA≈ûLIQ QRUPLARI (SAƒûDA) -->
                        <div class="table-title-group">
                            <h2 class="table-title">
                                <i class="fas fa-building table-icon"></i>
                                Dig…ôr ≈ûirk…ôtl…ôrin ƒ∞≈ül…ôri
                            </h2>
                            <div class="table-subtitle" id="externalMeta">
                                Dig…ôr ≈üirk…ôtl…ôrd…ôn g…ôl…ôn i≈ü sorƒüularƒ±
                            </div>
                        </div>
                    </div>
                </div>

                <div class="table-wrapper">
                    <table class="excel-table data-table">
                        <thead>
                            <tr>
                                <th class="text-center">S/S</th>
                                <th>Tarix</th>
                                <th>≈ûirk…ôt</th>
                                <th>Kim t…ôr…ôfind…ôn</th>
                                <th class="actions-col">∆èm…ôliyyatlar</th>
                                <th>ƒ∞≈ü adƒ±</th>
                                <th class="description-col">Tap≈üƒ±rƒ±q a√ßƒ±qlamasƒ±</th>
                                <th>Status</th>
                                <th>Son m√ºdd…ôt</th>
                                <th class="file-col">Fayl</th>
                            </tr>
                        </thead>
                        <tbody id="externalTableBody">
                            <tr class="empty-row">
                                <td colspan="9">
                                    <div class="empty-state">
                                        <i class="fas fa-building fa-2x"></i>
                                        <h3>Dig…ôr ≈ûirk…ôt ƒ∞≈ül…ôri</h3>
                                        <p>Hazƒ±rda dig…ôr ≈üirk…ôtl…ôrd…ôn he√ß bir i≈ü sorƒüusu yoxdur.</p>
                                        <p class="empty-hint">Dig…ôr ≈üirk…ôtl…ôr siz…ô i≈ü g√∂nd…ôrdikd…ô burada g√∂r√ºn…ôc…ôk.</p>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="table-footer">

                </div>
            </section>

            <!-- Archive Toggle Button -->
            <div class="archive-toggle-container">
                <button class="archive-toggle-btn" id="archiveToggleBtn">
                    <i class="fas fa-chevron-down"></i>
                    <span>Arxiv ƒ∞≈ül…ôri G√∂st…ôr</span>
                </button>
            </div>

            <!-- Archive Section (ƒ∞lk ba≈üda gizli) -->
            <section class="table-card archive-section hidden">
                <div class="table-header">
                    <div class="table-meta">

                        <div class="table-title-group">
                            <h2 class="table-title">
                                <i class="fas fa-archive table-icon"></i>
                                Arxiv
                            </h2>
                            <div class="table-subtitle" id="archiveMeta">
                                Tamamlanmƒ±≈ü v…ô arxivl…ônmi≈ü i≈ül…ôr
                            </div>
                        </div>
                        <div class="table-actions">
                            <button class="table-action-btn" id="archiveSortBtn" title="Sƒ±rala">
                                <i class="fas fa-sort-amount-down"></i>
                            </button>

                            <!-- Prev Button -->
                            <button class="table-action-btn" id="archivePrevBtn" title="∆èvv…ôlki s…ôhif…ô">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <!-- Next Button -->
                            <button class="table-action-btn" id="archiveNextBtn" title="N√∂vb…ôti s…ôhif…ô">
                                <i class="fas fa-chevron-right"></i>
                            </button>

                        </div>
                        <div class="table-actions">
                            <button class="secondary-btn btn-sm" id="exportArchiveBtn">
                                <i class="fas fa-download"></i>
                                Export
                            </button>
                        </div>
                    </div>
                </div>

                <div class="table-wrapper">
                    <table class="excel-table data-table">
                        <thead>
                            <tr>
                                <th class="text-center">S/S</th>
                                <th>Tarix</th>
                                <th>≈ûirk…ôt</th>
                                <th>Kim t…ôr…ôfind…ôn</th>
                                <th>ƒ∞cra ed…ôn</th>
                                <th>≈û√∂b…ô</th>
                                <th>ƒ∞≈üin n√∂v√º</th>
                                <th class="description-col">Tap≈üƒ±rƒ±q a√ßƒ±qlamasƒ±</th>
                                <th class="file-col">Fayl</th>
                                <th>Son m√ºdd…ôt</th>
                                <th>Status</th>
                                <th>ƒ∞cra tarixi</th>
                                <th>ƒ∞cra m√ºdd…ôti</th>
                                <th>Saatlƒ±q …ôm…ôk haqqƒ±</th>
                                <th>Formala≈üan …ôm…ôk haqqƒ±</th>
                            </tr>
                        </thead>
                        <tbody id="archiveTableBody">
                            <tr class="empty-row">
                                <td colspan="16">
                                    <div class="empty-state">
                                        <i class="fas fa-archive fa-2x"></i>
                                        <h3>Arxivl…ônmi≈ü ƒ∞≈ül…ôr</h3>
                                        <p>Hazƒ±rda he√ß bir arxiv i≈üi yoxdur.</p>
                                        <p class="empty-hint">Tamamlanmƒ±≈ü i≈ül…ôr avtomatik olaraq buraya arxivl…ônir.</p>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="table-footer">
                    <div class="table-summary">
                        <span id="archiveSummary">0 arxiv qeydi</span>
                    </div>
                    <div class="archive-actions">
                        <button class="secondary-btn btn-icon" id="archiveLoadMoreBtn" type="button" disabled>
                            <i class="fas fa-spinner fa-spin"></i>
                            <span>Y√ºkl…ônir...</span>
                        </button>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="page-footer">
            <div class="footer-content">
                <div class="footer-info">
                    <span class="footer-brand">Task Manager Pro ¬© 2024</span>
                    <span class="footer-separator">‚Ä¢</span>
                    <span class="footer-version">v2.1.0</span>
                    <span class="footer-separator">‚Ä¢</span>
                    <span class="footer-status" id="connectionStatus">
                        <i class="fas fa-circle online"></i>
                        Onlayn
                    </span>
                </div>
                <div class="footer-links">
                    <a href="#" class="footer-link">K√∂m…ôk</a>
                    <a href="#" class="footer-link">S…ôn…ôdl…ôr</a>
                    <a href="#" class="footer-link">∆èlaq…ô</a>
                </div>
            </div>
        </footer>
    </div>

    <!-- Modals -->

    <!-- Add/Edit Task Modal -->
    <div class="modal-backdrop" id="taskModal">
        <div class="modal modal-lg" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
            <div class="modal-header">
                <div class="modal-title-group">
                    <div class="modal-title" id="modalTitle">
                        <i class="fas fa-plus-circle"></i>
                        <span>Yeni ƒ∞≈ü ∆èlav…ô Et</span>
                    </div>
                    <div class="modal-subtitle">Yeni i≈ü tap≈üƒ±rƒ±ƒüƒ± yaratmaq √º√ß√ºn b√ºt√ºn m…ôlumatlarƒ± doldurun</div>
                </div>
                <button class="close-btn" id="closeModalBtn" aria-label="Baƒüla">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <form id="taskForm" class="modal-form">
                <div class="form-tabs">
                    <div class="form-tab active" data-tab="basic">
                        <span>∆èsas M…ôlumatlar</span>
                    </div>
                    <div class="form-tab" data-tab="details">
                        <span>Detallar</span>
                    </div>
                </div>

                <div class="form-content">
                    <!-- Basic Information Tab -->
                    <div class="form-tab-content active" id="basicTab">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="companySelect" class="form-label">
                                    <i class="fas fa-building"></i>
                                    ≈ûirk…ôt
                                </label>
                                <div class="select-wrapper">
                                    <select id="companySelect" name="company_id" required class="form-select">
                                        <option value="">≈ûirk…ôt se√ßin</option>
                                    </select>
                                    <i class="fas fa-chevron-down select-icon"></i>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="dueAtInput" class="form-label">
                                    <i class="fas fa-calendar-times"></i>
                                    Son M√ºdd…ôt
                                </label>
                                <input
                                    id="dueAtInput"
                                    name="due_date"
                                    type="date"
                                    required
                                    class="form-input"
                                />
                            </div>
                            <div class="form-group">
                                <div class="checkbox-group">
                                    <input type="checkbox" id="isVisibleToOtherCompanies" name="is_visible_to_other_companies" class="checkbox-input">
                                    <label for="isVisibleToOtherCompanies" class="checkbox-label">
                                        <i class="fas fa-eye"></i>
                                        Se√ßilmi≈ü ≈üirk…ôt…ô g√∂st…ôr
                                    </label>
                                    <div class="form-hint">
                                        Bu task-ƒ± se√ßdiyiniz ≈üirk…ôtin "Dig…ôr ≈üirk…ôtl…ôr" siyahƒ±sƒ±nda g√∂st…ôr
                                        <br>
                                        <small>Yalnƒ±z alt ≈üirk…ôtl…ôr √º√ß√ºn i≈ül…ôyir</small>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="executorSelect" class="form-label">
                                    <i class="fas fa-user-tie"></i>
                                    ƒ∞cra Ed…ôn
                                </label>
                                <div class="select-wrapper">
                                    <select id="executorSelect" name="executor_user_id" required class="form-select">
                                        <option value="">ƒ∞≈ü√ßi se√ßin</option>
                                    </select>
                                    <i class="fas fa-chevron-down select-icon"></i>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="departmentSelect" class="form-label">
                                    <i class="fas fa-sitemap"></i>
                                    ≈û√∂b…ô
                                </label>
                                <div class="select-wrapper">
                                    <select id="departmentSelect" name="department_id" required class="form-select">
                                        <option value="">≈û√∂b…ô se√ßin</option>
                                    </select>
                                    <i class="fas fa-chevron-down select-icon"></i>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="taskTypeSelect" class="form-label">
                                    <i class="fas fa-tasks"></i>
                                    ƒ∞≈üin N√∂v√º
                                </label>
                                <div class="select-wrapper">
                                    <select id="taskTypeSelect" name="task_type_id" required class="form-select">
                                        <option value="">ƒ∞≈ü n√∂v√º se√ßin</option>
                                    </select>
                                    <i class="fas fa-chevron-down select-icon"></i>
                                </div>
                            </div>

                            <div class="form-group" style="grid-column: span 2;">
                                <label for="descriptionInput" class="form-label">
                                    <i class="fas fa-align-left"></i>
                                    Tap≈üƒ±rƒ±q A√ßƒ±qlamasƒ±
                                </label>
                                <textarea
                                    id="descriptionInput"
                                    name="description"
                                    placeholder="Tap≈üƒ±rƒ±ƒüƒ±n detallƒ± t…ôsvirini yazƒ±n..."
                                    rows="4"
                                    class="form-textarea"
                                ></textarea>
                                <div class="form-hint">Tap≈üƒ±rƒ±ƒüƒ± d…ôqiq t…ôsvir edin</div>
                            </div>
                        </div>
                    </div>

                    <!-- Details Tab -->

                    <div class="form-tab-content" id="detailsTab">
                        <div class="form-grid">
                            <!-- Fayl Upload Section -->
                            <div class="form-group">
                                <label for="taskAttachment" class="form-label">
                                    <i class="fas fa-paperclip"></i>
                                    Fayl ∆èlav…ôsi
                                </label>
                                <div class="file-upload-zone" id="fileDropZone">
                                    <div class="file-upload-icon">
                                        <i class="fas fa-cloud-upload-alt fa-2x"></i>
                                    </div>
                                    <div class="file-upload-text">
                                        Faylƒ± buraya s√ºr√º≈üd√ºr√ºn v…ô ya klikl…ôyin
                                    </div>
                                    <div class="file-upload-hint">
                                        D…ôst…ôkl…ôn…ôn formatlar: PDF, Excel, Word, ≈û…ôkil, Video, Audio
                                    </div>
                                    <input
                                        type="file"
                                        id="taskAttachment"
                                        name="attachment"
                                        accept=".xlsx,.xls,.pdf,.jpg,.png,.jpeg,.doc,.docx,.mp4,.avi,.mov,.mp3,.wav,.ogg,.zip,.rar"
                                        class="file-input"
                                        hidden
                                        multiple
                                    />
                                </div>
                                <div class="file-list" id="fileList"></div>
                                <div id="fileUploadStatus" style="display: none;">
                                    <div class="upload-progress">
                                        <div class="progress-bar">
                                            <div class="progress-fill" id="uploadProgress"></div>
                                        </div>
                                        <span class="upload-text">
                                            <i class="fas fa-spinner fa-spin"></i>
                                            Fayl y√ºkl…ônir...
                                        </span>
                                    </div>
                                </div>
                            </div>

                            <!-- S…ôs Qeyd Etm…ô Section -->
                            <div class="form-group" style="grid-column: span 2;">
                                <label class="form-label">
                                    <i class="fas fa-microphone"></i>
                                    S…ôs Qeydi ∆èlav…ô Et
                                </label>
                                <div class="audio-recorder-container">
                                    <div class="audio-recorder-controls">
                                        <button type="button" class="btn btn-outline-primary" id="startRecordingBtn">
                                            <i class="fas fa-microphone"></i>
                                            S…ôs Qeydin…ô Ba≈üla
                                        </button>
                                        <button type="button" class="btn btn-outline-danger" id="stopRecordingBtn" disabled>
                                            <i class="fas fa-stop"></i>
                                            Dayandƒ±r
                                        </button>
                                        <button type="button" class="btn btn-outline-success" id="saveRecordingBtn" disabled>
                                            <i class="fas fa-save"></i>
                                            Saxla
                                        </button>
                                        <button type="button" class="btn btn-outline-secondary" id="cancelRecordingBtn" disabled>
                                            <i class="fas fa-times"></i>
                                            L…ôƒüv et
                                        </button>
                                    </div>

                                    <div class="audio-recorder-status">
                                        <div id="recordingStatus" class="recording-status">
                                            <i class="fas fa-circle text-muted"></i>
                                            <span>S…ôs qeydi hazƒ±rdƒ±r</span>
                                        </div>
                                        <div id="recordingTimer" class="recording-timer" style="display: none;">
                                            <i class="fas fa-clock"></i>
                                            <span id="timerDisplay">00:00</span>
                                        </div>
                                    </div>

                                    <div class="audio-recorder-visualizer">
                                        <canvas id="audioVisualizer" width="400" height="60"></canvas>
                                    </div>

                                    <div class="audio-recorder-preview" id="audioPreview" style="display: none;">
                                        <div class="audio-player">
                                            <audio id="recordedAudio" controls></audio>
                                            <div class="audio-info">
                                                <span id="audioDuration">M√ºdd…ôt: 0:00</span>
                                                <span id="audioSize">√ñl√ß√º: 0 KB</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-hint">
                                    Maksimum qeyd m√ºdd…ôti: 5 d…ôqiq…ô. S…ôs qeydi .wav formatƒ±nda saxlanƒ±lacaq.
                                </div>

                                <!-- Hidden input for audio data -->
                                <input type="hidden" id="audioData" name="audio_data">
                                <input type="hidden" id="audioFilename" name="audio_filename">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <div class="form-navigation">
                        <button type="button" class="secondary-btn btn-icon" id="prevTabBtn">
                            <i class="fas fa-arrow-left"></i>
                            <span>∆èvv…ôlki</span>
                        </button>
                        <div class="form-steps">
                            <span class="step active" data-step="1"></span>
                            <span class="step" data-step="2"></span>
                        </div>
                        <button type="button" class="secondary-btn btn-icon" id="nextTabBtn">
                            <span>N√∂vb…ôti</span>
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="secondary-btn" id="cancelBtn">
                            <i class="fas fa-times"></i>
                            L…ôƒüv et
                        </button>
                        <button type="submit" class="primary-btn" id="saveBtn">
                            <i class="fas fa-save"></i>
                            Yadda Saxla
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- Task Details Modal -->
    <div class="modal-backdrop" id="descriptionModal">
        <div class="modal description-modal" role="dialog" aria-modal="true" aria-labelledby="descriptionModalTitle">
            <div class="modal-header">
                <div class="modal-title" id="descriptionModalTitle">
                    <i class="fas fa-info-circle"></i>
                    Tap≈üƒ±rƒ±q Detallarƒ±
                </div>
                <button class="close-btn" id="closeDescriptionBtn" aria-label="Baƒüla">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-content">
                <div class="task-detail-grid">
                    <div class="task-detail-section">
                        <div class="detail-label">Tap≈üƒ±rƒ±q Kodu</div>
                        <div class="detail-value" id="detailTaskCode">-</div>
                    </div>

                    <div class="task-detail-section">
                        <div class="detail-label">Status</div>
                        <div class="detail-value">
                            <span class="status-badge status-pending" id="detailStatus">G√∂zl…ôm…ôd…ô</span>
                        </div>
                    </div>

                    <div class="task-detail-section full-width">
                        <div class="detail-label">A√ßƒ±qlama</div>
                        <div class="detail-text multiline" id="detailDescription">
                            A√ßƒ±qlama yoxdur
                        </div>
                    </div>

                    <div class="task-detail-section full-width">
                        <div class="detail-label">Qeydl…ôr</div>
                        <div class="detail-text multiline" id="detailNotes">
                            Qeyd yoxdur
                        </div>
                    </div>

                    <div class="task-detail-section">
                        <div class="detail-label">Yaradƒ±lma Tarixi</div>
                        <div class="detail-value" id="detailCreatedAt">-</div>
                    </div>

                    <div class="task-detail-section">
                        <div class="detail-label">Son M√ºdd…ôt</div>
                        <div class="detail-value" id="detailDueAt">-</div>
                    </div>

                    <div class="task-detail-section">
                        <div class="detail-label">Tamamlanma Tarixi</div>
                        <div class="detail-value" id="detailCompletedAt">-</div>
                    </div>

                    <div class="task-detail-section">
                        <div class="detail-label">ƒ∞cra M√ºdd…ôti</div>
                        <div class="detail-value" id="detailDuration">-</div>
                    </div>

                    <div class="task-detail-section full-width">
                        <div class="detail-label">Fayl ∆èlav…ôl…ôri</div>
                        <div class="modal-file-attachments" id="detailAttachments">
                            <div class="empty-attachments">
                                <i class="fas fa-paperclip"></i>
                                <span>Fayl …ôlav…ô edilm…ôyib</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="secondary-btn" id="closeDetailsBtn">
                    <i class="fas fa-times"></i>
                    Baƒüla
                </button>
            </div>
        </div>
    </div>

    <!-- Filter Modal -->
    <div class="modal-backdrop" id="filterModal">
        <div class="modal filter-modal" role="dialog" aria-modal="true" aria-labelledby="filterModalTitle">
            <div class="modal-header">
                <div class="modal-title" id="filterModalTitle">
                    <i class="fas fa-filter"></i>
                    Filtrl…ôm…ô Se√ßiml…ôri
                </div>
                <button class="close-btn" id="closeFilterBtn" aria-label="Baƒüla">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="filterForm" class="modal-form">
                <div class="form-content">

                    <!-- YENƒ∞: C…ôdv…ôl Se√ßim B√∂lm…ôsi -->
                    <div class="form-group" style="grid-column: span 2; margin-bottom: 20px;">
                        <label class="form-label">
                            <i class="fas fa-table"></i>
                            Filtrl…ôn…ôc…ôk C…ôdv…ôl
                        </label>
                        <div class="table-selection-radios">
                            <div class="radio-group">
                                <input type="radio" id="filterActiveTable" name="filter_table" value="active" class="radio-input" checked>
                                <label for="filterActiveTable" class="radio-label">
                                    <span class="radio-icon">
                                        <i class="fas fa-tasks"></i>
                                    </span>
                                    <span class="radio-text">
                                        <strong>≈ûirk…ôtin Aktiv ƒ∞≈ül…ôri</strong>
                                        <small>Yalnƒ±z aktiv v…ô g√∂zl…ôy…ôn task-lar</small>
                                    </span>
                                </label>
                            </div>

                            <div class="radio-group">
                                <input type="radio" id="filterExternalTable" name="filter_table" value="external" class="radio-input">
                                <label for="filterExternalTable" class="radio-label">
                                    <span class="radio-icon">
                                        <i class="fas fa-building"></i>
                                    </span>
                                    <span class="radio-text">
                                        <strong>Dig…ôr ≈ûirk…ôtl…ôrin ƒ∞≈ül…ôri</strong>
                                        <small>Xarici ≈üirk…ôtl…ôrd…ôn g…ôl…ôn task-lar</small>
                                    </span>
                                </label>
                            </div>

                            <div class="radio-group">
                                <input type="radio" id="filterArchiveTable" name="filter_table" value="archive" class="radio-input">
                                <label for="filterArchiveTable" class="radio-label">
                                    <span class="radio-icon">
                                        <i class="fas fa-archive"></i>
                                    </span>
                                    <span class="radio-text">
                                        <strong>Arxiv ƒ∞≈ül…ôr</strong>
                                        <small>Tamamlanmƒ±≈ü v…ô arxivl…ônmi≈ü task-lar</small>
                                    </span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Yaranma Tarixi Aralƒ±ƒüƒ± -->
                    <div class="form-group" style="grid-column: span 2;">
                        <label class="form-label">
                            <i class="fas fa-calendar-plus"></i>
                            Yaranma Tarixi Aralƒ±ƒüƒ±
                        </label>
                        <div class="inline-fields">
                            <div class="date-field">
                                <label for="filterCreatedFrom" class="field-label">Ba≈ülanƒüƒ±c</label>
                                <input
                                    id="filterCreatedFrom"
                                    name="created_from"
                                    type="datetime-local"
                                    class="form-input"
                                />
                            </div>
                            <div class="date-field">
                                <label for="filterCreatedTo" class="field-label">Son</label>
                                <input
                                    id="filterCreatedTo"
                                    name="created_to"
                                    type="datetime-local"
                                    class="form-input"
                                />
                            </div>
                        </div>
                    </div>

                    <!-- Son M√ºdd…ôt Tarixi Aralƒ±ƒüƒ± -->
                    <div class="form-group" style="grid-column: span 2;">
                        <label class="form-label">
                            <i class="fas fa-calendar-times"></i>
                            Son M√ºdd…ôt Aralƒ±ƒüƒ±
                        </label>
                        <div class="inline-fields">
                            <div class="date-field">
                                <label for="filterDueFrom" class="field-label">Ba≈ülanƒüƒ±c</label>
                                <input
                                    id="filterDueFrom"
                                    name="due_from"
                                    type="datetime-local"
                                    class="form-input"
                                />
                            </div>
                            <div class="date-field">
                                <label for="filterDueTo" class="field-label">Son</label>
                                <input
                                    id="filterDueTo"
                                    name="due_to"
                                    type="datetime-local"
                                    class="form-input"
                                />
                            </div>
                        </div>
                    </div>

                    <!-- Qalan filtrl…ôr -->
                    <div class="form-group">
                        <label for="filterCompanySelect" class="form-label">
                            <i class="fas fa-building"></i>
                            ≈ûirk…ôt
                        </label>
                        <div class="select-wrapper">
                            <select id="filterCompanySelect" name="company_id" class="form-select">
                                <option value="">Hamƒ±sƒ±</option>
                            </select>
                            <i class="fas fa-chevron-down select-icon"></i>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="filterExecutorSelect" class="form-label">
                            <i class="fas fa-user-tie"></i>
                            ƒ∞cra Ed…ôn
                        </label>
                        <div class="select-wrapper">
                            <select id="filterExecutorSelect" name="executor_user_id" class="form-select">
                                <option value="">Hamƒ±sƒ±</option>
                            </select>
                            <i class="fas fa-chevron-down select-icon"></i>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="filterDepartmentSelect" class="form-label">
                            <i class="fas fa-sitemap"></i>
                            ≈û√∂b…ô
                        </label>
                        <div class="select-wrapper">
                            <select id="filterDepartmentSelect" name="department_id" class="form-select">
                                <option value="">Hamƒ±sƒ±</option>
                            </select>
                            <i class="fas fa-chevron-down select-icon"></i>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="filterTaskTypeSelect" class="form-label">
                            <i class="fas fa-tasks"></i>
                            ƒ∞≈üin N√∂v√º
                        </label>
                        <div class="select-wrapper">
                            <select id="filterTaskTypeSelect" name="task_type_id" class="form-select">
                                <option value="">Hamƒ±sƒ±</option>
                            </select>
                            <i class="fas fa-chevron-down select-icon"></i>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="filterStatusSelect" class="form-label">
                            <i class="fas fa-flag"></i>
                            Status
                        </label>
                        <div class="select-wrapper">
                            <select id="filterStatusSelect" name="status" class="form-select">
                                <option value="">Hamƒ±sƒ±</option>
                                <option value="pending">G√∂zl…ôm…ôd…ô</option>
                                <option value="in_progress">ƒ∞cra olunur</option>
                                <option value="completed">Tamamlanmƒ±≈ü</option>
                                <option value="cancelled">L…ôƒüv edilmi≈ü</option>
                                <option value="overdue">Vaxtƒ± ke√ßmi≈ü</option>
                            </select>
                            <i class="fas fa-chevron-down select-icon"></i>
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="secondary-btn" id="resetFiltersBtn">
                        <i class="fas fa-redo"></i>
                        Sƒ±fƒ±rla
                    </button>
                    <button type="submit" class="primary-btn">
                        <i class="fas fa-check"></i>
                        Filtrl…ô
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Profile Menu (Hidden until needed) -->
    <div class="profile-menu" id="profileMenu">
        <div class="profile-menu-header">
            <div class="profile-menu-user">
                <div class="profile-menu-avatar">
                    <i class="fas fa-user-circle"></i>
                </div>
                <div class="profile-menu-info">
                    <span class="profile-menu-name" id="profileMenuName">Administrator</span>
                    <span class="profile-menu-email" id="profileMenuEmail">admin@example.com</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loader">
                <div></div>
                <div></div>
            </div>
            <p class="loading-text" id="loadingText">Y√ºkl…ônir...</p>
        </div>
    </div>

    <!-- Notifications Container -->
    <div class="notifications-container" id="notificationsContainer"></div>

    <!-- JavaScript fayllarƒ± -->
    <script src="../assets/js/task_js/apiService.js"></script>
    <script src="../assets/js/task_js/authService.js"></script>
    <script src="../assets/js/task_js/cacheService.js"></script>
    <script src="../assets/js/task_js/formatters.js"></script>
    <script src="../assets/js/task_js/excelExport.js"></script>
    <script src="../assets/js/task_js/buttonManager.js"></script>
    <script src="../assets/js/task_js/validators.js"></script>
    <script src="../assets/js/task_js/notification.js"></script>
    <script src="../assets/js/task_js/formManager.js"></script>
    <script src="../assets/js/task_js/audioRecorder.js"></script>
    <script src="../assets/js/task_js/soundManager.js"></script>
    <script src="../assets/js/task_js/fileUpload.js"></script>
    <script src="../assets/js/task_js/modalManager.js"></script>
    <script src="../assets/js/task_js/tableManager.js"></script>
    <script src="../assets/js/task_js/taskEditModul.js"></script>
    <script src="../assets/js/task_js/soundManager.js"></script>
    <script src="../assets/js/task_js/websocketManager.js"></script>
    <script src="../assets/js/task_js/task.js"></script>


</body>
</html>